# # #:kivy!

# kivy MDApp
# https://pictogrammers.com/library/mdi/   # ICONs
# https://www.flaticon.com/free-icons/law

# Layouts
# https://subscription.packtpub.com/book/programming/9781783281596/1/ch01lvl1sec11/embedding-layouts

# Icons: arrow-left-bold, arrow-right-bold, microphone
# Icon: sail-boat, sail-boat-sink
# weather-windy

# selected_color: "#0c6c4d"
# focus_color: "#e7e4c0"


# kivymd 1.1.1


# https://www.youtube.com/watch?v=d0SQXNSZvKQ  Liste Speichern




MDScreenManager:
    WelcomeWindow:
    QuizWindow:
    SetupWindow:
    LawWindow:
    Haftungindow:


<WelcomeWindow>:
    name: "welcomewindow"

    GridLayout:
        cols: 1
        size_hint: 0.6, 0.6
        pos_hint: {"center_x": 0.5, "center_y": 0.5}

        Image: 
            source: "assets/logos/SAIL_Right_of_way.png"

        # MDRectangleFlatButton:
        MDRoundFlatIconButton:
            text: "Los aufs Wasser"
            icon: "sail-boat"
            theme_text_color: "Custom"
            text_color: "blue"
            line_color: "blue"
            halign: "center"
            size_hint: (0.1, 0.2)
            pos_hint: {"center_x": 0.5, "center_y": 0.3}
            on_release: 
                root.entrance_button_behavior()


# https://stackoverflow.com/questions/66455785/scrollable-text-field-in-kivymd
<LawWindow>:
    name: "lawwindow"

    GridLayout:
        cols: 1
        size_hint: 0.995, 0.995

        GridLayout:
            cols: 3
            size_hint: 0.05, 0.1

            MDLabel:
                text:""
                halign: "center"
                text_color: "black"

            MDRoundFlatIconButton:
                text: "Zurück zum Spiel"
                icon: "sail-boat"
                theme_text_color: "Custom"
                text_color: "blue"
                line_color: "blue"
                halign: "center"
                size_hint: (0.1, 0.1)
                pos_hint: {"center_x": 0.5, "center_y": 0.3}
                on_release: 
                    root.entrance_button_behavior()

            MDLabel:
                text:""
                halign: "center"
                text_color: "black"



        MDScrollView:  # ScrollView:
        #     id: scroll
        #     # md_bg_color: 1,1,1,1
        #     # CodeInput:
        #         # text:""
        #         # height: max(self.minimum_height, scroll.height)
        #         # text: "KVR Regeln \n \n Regel 12 Segelfahrzeuge \n Wenn zwei Segelfahrzeuge \n sich einander so nähern, dass  \n die Möglichkeit der Gefahr  \n eines Zusammenstosses besteht,  \n muss das eine dem \n anderen wie folgt ausweichen: \n \n i) Wenn sie den Wind nicht \n von derselben seite haben,\n muss das Fahrzeug, das den \n Wind von der Backbord hat, \n dem anderen ausweichen.\n \n ii) wenn sie den Wind von \n derselben Seite haben, muss \n das luvwärtige Fahrzeug \n dem leewärtigen ausweichen. \n \n iii) wenn ein Fahrzeug mit \n Wind von Backbord ein \n Fahrzeug in Luv sichtet \n und nicht mit Sicherheit \n feststllen kann, ob das \n andere Fahrzeug den Wind \n von Backbord oder von \n Steuerbord hat, muss \n es dem anderen ausweichen. \n \n Im Sinne der Regel ist  \n die Luvseite diejenige  \n Seite, die dem ggesetzten  \n Grosssegel gegenüberliegt..."


            MDLabel:
                text_color: "black"
                size_hint: 1, None
                height: self.texture_size[1]
                text_size: self.width, None
                text: "KVR Regeln \n \n Regel 12 Segelfahrzeuge \n Wenn zwei Segelfahrzeuge \n sich einander so nähern, dass  \n die Möglichkeit der Gefahr  \n eines Zusammenstosses besteht,  \n muss das eine dem \n anderen wie folgt ausweichen: \n \n i) Wenn sie den Wind nicht \n von derselben seite haben,\n muss das Fahrzeug, das den \n Wind von der Backbord hat, \n dem anderen ausweichen.\n \n ii) wenn sie den Wind von \n derselben Seite haben, muss \n das luvwärtige Fahrzeug \n dem leewärtigen ausweichen. \n \n iii) wenn ein Fahrzeug mit \n Wind von Backbord ein \n Fahrzeug in Luv sichtet \n und nicht mit Sicherheit \n feststllen kann, ob das \n andere Fahrzeug den Wind \n von Backbord oder von \n Steuerbord hat, muss \n es dem anderen ausweichen. \n \n Im Sinne der Regel ist  \n die Luvseite diejenige  \n Seite, die dem ggesetzten  \n Grosssegel gegenüberliegt..."


<Haftungindow>:
    name: "haftungwindow"

    GridLayout:
        cols: 1
        size_hint: 0.995, 0.995

        GridLayout:
            cols: 3
            size_hint: 0.05, 0.1

            MDLabel:
                text:""
                halign: "center"
                text_color: "black"

            MDRoundFlatIconButton:
                text: "Zurück zum Spiel"
                icon: "sail-boat"
                theme_text_color: "Custom"
                text_color: "blue"
                line_color: "blue"
                halign: "center"
                size_hint: (0.1, 0.1)
                pos_hint: {"center_x": 0.5, "center_y": 0.3}
                on_release: 
                    root.entrance_button_behavior()

            MDLabel:
                text:""
                halign: "center"
                text_color: "black"



        MDScrollView:

            MDLabel:
                text_color: "black"
                size_hint: 1, None
                height: self.texture_size[1]
                text_size: self.width, None
                text: "Haftungsausschuss \n \n Es kann keinerlei Haftung für Aktualität, Richtigkeit und Vollständigkeit der bereitgestellten Informationen in dieser App übernehmen werden. Im Zweifel sollten Nutzer der App immer die offiziellen Verlautbarungen (KVR und lokale Regelungen) der einschlägigen Behörden auf Bundes-, Landes- und kommunaler Ebene konsultieren und ihr Verhalten ausschließlich nach diesen ausrichten. \n \n Haftungsansprüche, welche sich auf Schäden materieller oder ideeller Art beziehen, die durch die Nutzung oder Nichtnutzung der dargebotenen Informationen bzw. durch die Nutzung fehlerhafter und unvollständiger Informationen verursacht wurden, sind grundsätzlich ausgeschlossen."



<SetupWindow>:
    name: "setupwindow"

    number_of_questions: number_of_questions

    GridLayout:
        cols: 1
        size_hint: 0.995, 0.995

        GridLayout:
            cols: 1
            size_hint: 0.6, 0.6
            pos_hint: {"center_x": 0.5, "center_y": 0.5}

            Image: 
                source: "assets/logos/SAIL_logo.png"

            MDLabel:
                size_hint: (1, 0.2)
                text: "Anzahl der Fragen"
                halign: "center"

            GridLayout:
                cols: 1
                size_hint: 0.6, 0.6
                pos_hint: {"center_x": 0.5, "center_y": 0.5}

                MDTextField:
                    id: number_of_questions
                    # size_hint: (1, 0.5)
                    hint_text: "Nummer eintragen"
                    helper_text: "Fragenanzahl: 4 - 30"
                    helper_text_mode: "on_focus"

            MDLabel:
                text:""
                halign: "center"
                text_color: "black"

            MDRoundFlatIconButton:
                text: "Zum Spiel"
                icon: "sail-boat"
                theme_text_color: "Custom"
                text_color: "blue"
                line_color: "blue"
                halign: "center"
                size_hint: (0.1, 0.1)
                pos_hint: {"center_x": 0.5, "center_y": 0.3}
                on_release: 
                    root.switch_to_second_view()
                    root.restart_quiz()

            MDLabel:
                text:""
                halign: "center"
                text_color: "black"


<QuizWindow>:
    name: "quizwindow"

    # https://kivymd.readthedocs.io/en/1.1.1/behaviors/magic/

    # pictures
    sail_png: sail_png
    false_counter: false_counter
    true_counter: true_counter
    jumper_counter: jumper_counter

    GridLayout:
        cols: 1
        size_hint: 0.995, 0.995

        MDTopAppBar:
            # title: app.title
            # md_bg_color: "#e7e4c0"
            # https://pictogrammers.com/library/mdi/
            # https://github.com/kivymd/KivyMD/blob/master/kivymd/icon_definitions.py
            left_action_items: [["ship-wheel", lambda x: left_nav_drawer.set_state("open"), "", ""], ["gavel", lambda x: root.switch_to_lawview(x), "", ""]]

            # scale-balance , gavel

            # TODO: switch and open rechtliches app, haftungsausschuss

            right_action_items: [["scale-balance", lambda x: root.switch_to_lawview(x), "", ""], ["information-variant", lambda x: right_nav_drawer.set_state("open"), "", ""]]


        GridLayout:
            cols: 2
            size_hint: (0.99, 0.15)

            MDLabel:
                size_hint: (1, 0.95)
                text: "Antworten"
                halign: "center"

            GridLayout:
                cols: 5


                MDLabel:
                    id: true_counter
                    size_hint: (1, 0.95)
                    text:"0"
                    halign: "center"
                    theme_text_color: "Custom"
                    text_color: 0, 1, 0, 1
                MDLabel:
                    size_hint: (1, 0.95)
                    text: "/"
                    halign: "center"
                MDLabel:
                    id: false_counter
                    size_hint: (1, 0.95)
                    text:"0"
                    halign: "center"
                    theme_text_color: "Custom"
                    text_color: 1, 0, 0, 1
                MDLabel:
                    size_hint: (1, 0.95)
                    text: "/"
                    halign: "center"
                MDLabel:
                    id: jumper_counter
                    size_hint: (1, 0.95)
                    text:"0"
                    halign: "center"
                    theme_text_color: "Custom"
                    text_color: .6, .5, .1, 1

        GridLayout:
            cols: 1
            # size_hint: 1.2, 1.2


            # Image:
            FitImage: 
                id: sail_png
                # size_hint: 1, 1
                #pos_hint: {"x": 0, "y": 0}
                #keep_ratio: True
                # allow_stretch: True
                source: "assets/sails/Stb_start.png"
                # size_hint: 
                size: 360, 360

        GridLayout:
            cols: 1
            size_hint: (0.99, 0.1)
            # pos_hint: {"center_x": 0.5, "center_y": 0.5}

            MDLabel:
                text:"Ich bin"
                # size_hint: (1, 0.5)
                halign: "center"
                text_color: "black"

        GridLayout:
            cols: 2
            size_hint: (0.99, 0.2)
            # pos_hint: {"center_x": 0.5, "center_y": 0.5}

            MDRoundFlatIconButton:
                text: "ausweichpflichtig"
                icon: "arrow-left-right-bold"
                theme_text_color: "Custom"
                text_color: "blue"
                line_color: "blue"
                halign: "center"
                size_hint: (0.5, 0.9)
                pos_hint: {"center_x": 0.5, "center_y": 0.3}
                on_release: 
                    root.ausweichen()
                    # pass

            MDRoundFlatIconButton:
                text: "kurshaltepflichtig"
                icon: "sail-boat"
                theme_text_color: "Custom"
                text_color: "blue"
                line_color: "blue"
                halign: "center"
                size_hint: (0.5, 0.9)
                pos_hint: {"center_x": 0.5, "center_y": 0.3}
                on_release: 
                    root.kurshalten()
                    # pass

        GridLayout:
            cols: 1
            size_hint: (0.99, 0.05)
            # pos_hint: {"center_x": 0.5, "center_y": 0.5}

            MDLabel:
                text:""
                # size_hint: (1, 0.5)
                halign: "center"
                text_color: "black"

        GridLayout:
            cols: 1
            size_hint: (0.99, 0.2)
            # pos_hint: {"center_x": 0.5, "center_y": 0.5}

            MDRoundFlatIconButton:
                text: "nächste Frage"
                icon: "help"
                theme_text_color: "Custom"
                text_color: "blue"
                line_color: "blue"
                halign: "center"
                size_hint: (0.9, 0.5)
                pos_hint: {"center_x": 0.5, "center_y": 0.3}
                on_release: 
                    root.weiter()
                    # pass

        GridLayout:
            cols: 1
            size_hint: (0.99, 0.15)
            # pos_hint: {"center_x": 0.5, "center_y": 0.5}
            MDLabel:
                text:""
                halign: "center"
                text_color: "black"

        MDBottomAppBar:

            MDTopAppBar:
                # title: ""
                icon: "sail-boat"  #"ship-wheel"  # "sail-boat"
                type: "bottom"
                on_action_button: root.restart_quiz()
                # left_action_items: [["sail-boat", lambda x: root.restart_quiz(), "", ""]]


    MDNavigationDrawer:
        id: left_nav_drawer
        radius: (0, 16, 16, 0)
        type: "modal"
        # https://kivymd.readthedocs.io/en/1.1.1/components/navigationdrawer/index.html
        # https://pictogrammers.com/library/mdi/

        MDNavigationDrawerMenu:

            MDNavigationDrawerHeader:
                title: " Options"
                title_color: "#4a4939"
                text: ""
                source: "assets/logos/SAIL_logo.png"
                spacing: "4dp"
                padding: "12dp", 0, 0, "56dp"


            # MDNavigationDrawerLabel:
            #     text: "Basics"

            MDNavigationDrawerDivider:

            MDNavigationDrawerItem:
                icon: "sail-boat"
                text: "Start"
                on_release: 
                    root.restart_quiz()

            MDNavigationDrawerItem:
                icon: "cog"
                text: "Setup"
                on_release: 
                    root.switch_to_setup_view()



    MDNavigationDrawer:
        id: right_nav_drawer
        anchor: "right"
        radius: (0, 16, 16, 0)
        type: "modal"

        # https://pictogrammers.com/library/mdi/

        MDNavigationDrawerMenu:

            MDNavigationDrawerHeader:
                title: "Impressum"
                title_color: "#4a4939"
                text: ""

            MDNavigationDrawerDivider:

            MDNavigationDrawerLabel:
                text: "Name der Firma"

            MDNavigationDrawerItem:
                icon: "information-outline"
                text: "H2 solutions"

            MDNavigationDrawerDivider:

            MDNavigationDrawerLabel:
                text: "Addresse"

            MDNavigationDrawerItem:
                icon: "email-newsletter"
                text: "Prinz-Carl-Anlage 25"
            MDNavigationDrawerItem:
                text: "67547 Worms"
            MDNavigationDrawerItem:
                text: "Deutschland"

            MDNavigationDrawerDivider:

            MDNavigationDrawerLabel:
                text: "Ansprechpartner"

            MDNavigationDrawerItem:
                icon: "account"
                text: "Heiko Kulinna"

            MDNavigationDrawerDivider:

            MDNavigationDrawerLabel:
                text: "Kontaktaufnahme"

            MDNavigationDrawerItem:
                icon: "email-edit-outline"
                text: "h2solutions@gmx.de"

            MDNavigationDrawerItem:
                icon: "phone"
                text: "01577 13 2 13 54"
            MDNavigationDrawerDivider:

            MDNavigationDrawerLabel:
                text: "Problem melden"

            # MDNavigationDrawerLabel:
            #     text: "https://github.com/heiko1234/kivy_sailcommander/issues"

            # MDIconButton:
            #     icon: "arrow-right-bold"
            #     # on_release: root.go_to_hyperlink()


            MDNavigationDrawerItem:
                icon: "github"
                # https://stackoverflow.com/questions/26886286/kivy-label-markup-link-change
                text: ' [ref=https://github.com/heiko1234/kivy_rightofway/issues]Report on Github[/ref]'
                text_color: 0,0,1,1
                # on_ref_press:
                #     pass
                on_release:
                    import webbrowser
                    webbrowser.open("https://github.com/heiko1234/kivy_sail_rightofway/issues")

            MDNavigationDrawerItem:
                icon: "github"
                text: "https://github.com/"
            MDNavigationDrawerItem:
                text: "heiko1234/"
            MDNavigationDrawerItem:
                text: "kivy_sail_rightofway/"
            MDNavigationDrawerItem:
                text: "issues"




            MDNavigationDrawerDivider:










